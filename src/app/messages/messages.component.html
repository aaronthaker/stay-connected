<ion-header>
  <ion-toolbar>
    <ion-title>
      Conversations
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-list>
    <ion-item *ngFor="let conversation of conversations"
      [routerLink]="['/conversation', conversation.contact._id]"
      class="conversation-item">
      <ion-avatar slot="start">
        <img [src]="'http://localhost:3000/' + conversation.contact.profileImage" />
      </ion-avatar>
      <ion-label>
        <h2 style="margin: 0px">{{conversation.contact.name}}</h2>
        <p style="margin:0px;color:darkgrey" *ngIf="getUnreadMessageCount(conversation.contact) > 0" class="ion-text-nowrap">{{getUnreadMessageCount(conversation.contact)}} new message(s)</p>
        <p *ngIf="conversation.lastMessage" [class.incoming]="conversation.lastMessage.senderId === messagesService.currentUserId">{{conversation.lastMessage.content}}</p>
      </ion-label>
      <ion-badge *ngIf="getUnreadMessageCount(conversation.contact) > 0" slot="end">{{getUnreadMessageCount(conversation.contact)}}</ion-badge>
    </ion-item>
  </ion-list>
</ion-content>
