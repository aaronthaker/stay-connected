from google.cloud import storage
import os

# Path to your clean service account key
os.environ["GOOGLE_APPLICATION_CREDENTIALS"] = "glencore-key.json"

# Initialize GCS client
client = storage.Client()

# Define the bucket and prefix
bucket_name = "behavox-glencore-surv-input"
prefix = "HR/"

try:
    bucket = client.get_bucket(bucket_name)
    blobs = bucket.list_blobs(prefix=prefix)

    print(f"Listing contents of gs://{bucket_name}/{prefix}:\n")
    found = False
    for blob in blobs:
        print(f"- {blob.name}")
        found = True

    if not found:
        print("Bucket is accessible, but no files found under HR/.")

except Exception as e:
    print("Access failed or bucket not reachable:")
    print(e)