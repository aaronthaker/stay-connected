let
    Source = Excel.CurrentWorkbook(){[Name="Closed_By_PwC_Last_7_Days"]}[Content],
    #"Changed Type" = Table.TransformColumnTypes(Source,{{"Alert ID", Int64.Type}, {"Name", type text}, {"Status", type text}, {"Escalation level", type text}, {"Comments", type text}, {"Justification", type text}, {"Current owner", type text}, {"All owners", type text}, {"Resolution status", type text}, {"Resolution level", type text}, {"Content date", type text}, {"Content IDs", type any}, {"Content types", type text}, {"Age in days", Int64.Type}, {"Closing date", type datetime}, {"Creation date", type text}, {"Date of first ownership", type text}, {"Total investigation time", Int64.Type}, {"Last update", type text}, {"QA creation date", type any}, {"QA assignment rules", type any}, {"QA owner", type any}, {"QA status", type any}, {"QA last update", type any}, {"Actions taken", type text}, {"Escalated from", type any}, {"Escalated to", type any}, {"Escalation date", type any}, {"Within7Days", type logical}}),
    
    // Add a column with a random number between 0 and 1
    #"Added Custom" = Table.AddColumn(#"Changed Type", "RandomValue", each Number.RandomBetween(0, 1)),
    
    // Sort the table based on the RandomValue column
    #"Sorted Rows" = Table.Sort(#"Added Custom",{{"RandomValue", Order.Ascending}}),
    
    // Add an index column
    #"Added Index" = Table.AddIndexColumn(#"Sorted Rows", "Index", 0, 1, Int64.Type),
    
    // Calculate the number of rows to keep (30% of the total rows)
    TotalRows = Table.RowCount(#"Added Index"),
    SampleSize = Number.Round(TotalRows * 0.3), // 30% of the total rows
    
    // Keep only the top SampleSize rows
    #"Filtered Rows" = Table.FirstN(#"Added Index", SampleSize),

    // Remove unnecessary columns if needed
    #"Removed Columns" = Table.RemoveColumns(#"Filtered Rows",{"RandomValue", "Index"})
in
    #"Removed Columns"