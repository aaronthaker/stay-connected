Sub FilterAndCreateSheet()
    Dim wsRaw As Worksheet, wsFiltered As Worksheet
    Dim lastRow As Long, headerRow As Long
    Dim rng As Range, filteredRng As Range
    Dim newSheetName As String
    
    ' Define worksheet names
    Set wsRaw = ThisWorkbook.Sheets("Raw Data")
    newSheetName = "Filtered Data"
    
    ' Check if "Filtered Data" already exists, delete if it does
    On Error Resume Next
    Application.DisplayAlerts = False
    Sheets(newSheetName).Delete
    Application.DisplayAlerts = True
    On Error GoTo 0
    
    ' Create the new sheet
    Set wsFiltered = ThisWorkbook.Sheets.Add(After:=wsRaw)
    wsFiltered.Name = newSheetName
    
    ' Find the last row with data
    lastRow = wsRaw.Cells(wsRaw.Rows.Count, "A").End(xlUp).Row
    headerRow = 1 ' Assuming headers are in the first row
    
    ' Set data range including headers
    Set rng = wsRaw.Range("A" & headerRow & ":Z" & lastRow) ' Adjust column range as needed
    
    ' Apply AutoFilter to Raw Data
    rng.AutoFilter Field:=9, Criteria1:="Closed" ' Resolution status (column I)
    rng.AutoFilter Field:=10, Criteria1:=Array("Initial Analysis", "Enhanced Analysis"), Operator:=xlFilterValues ' Resolution level (column J)
    rng.AutoFilter Field:=8, Criteria1:="*Joseph Goldstein*", Operator:=xlFilterValues ' All owners (column H)
    rng.AutoFilter Field:=8, Criteria1:="*Sam Lodge*", Operator:=xlOr ' All owners (column H)

    ' Copy filtered data to the new sheet
    Set filteredRng = rng.SpecialCells(xlCellTypeVisible)
    
    If Not filteredRng Is Nothing Then
        filteredRng.Copy
        wsFiltered.Range("A1").PasteSpecial Paste:=xlPasteValues
    End If

    ' Clear filters on Raw Data to reset view
    wsRaw.AutoFilterMode = False

    ' Notify user
    MsgBox "Filtered data has been copied to 'Filtered Data' sheet.", vbInformation
End Sub