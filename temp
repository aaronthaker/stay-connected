import tkinter as tk
from tkinter import filedialog
import difflib

def load_file(file_path):
    with open(file_path, 'r', encoding='utf-8') as file:
        return file.readlines()

def highlight_differences(content1, content2):
    # Use difflib to compute the differences
    differ = difflib.ndiff(content1, content2)
    
    # Highlight differences with HTML-like markers
    highlighted_content1 = []
    highlighted_content2 = []
    
    for line in differ:
        if line.startswith('- '):
            highlighted_content1.append('\033[91m' + line[2:] + '\033[0m')  # Red for removed
            highlighted_content2.append(line[2:])
        elif line.startswith('+ '):
            highlighted_content1.append(line[2:])
            highlighted_content2.append('\033[92m' + line[2:] + '\033[0m')  # Green for added
        elif line.startswith('? '):
            continue  # Ignore marker lines
        else:
            highlighted_content1.append(line[2:])
            highlighted_content2.append(line[2:])
    
    return highlighted_content1, highlighted_content2

def create_text_widget(root, content, side):
    text_widget = tk.Text(root, wrap='word')
    text_widget.pack(side=side, expand=True, fill='both')
    
    for line in content:
        text_widget.insert(tk.END, line)
    
    return text_widget

def main():
    # Load contents from files
    file1_path = filedialog.askopenfilename(title="Select the first file", initialfile="old.txt")
    file2_path = filedialog.askopenfilename(title="Select the second file", initialfile="july.txt")
    
    content1 = load_file(file1_path)
    content2 = load_file(file2_path)
    
    # Create a tkinter window
    root = tk.Tk()
    root.title("File Differences")
    
    # Highlight differences
    highlighted_content1, highlighted_content2 = highlight_differences(content1, content2)
    
    # Create text widgets
    create_text_widget(root, highlighted_content1, tk.LEFT)
    create_text_widget(root, highlighted_content2, tk.RIGHT)
    
    # Adjust fonts and text size if needed
    tk_font = ('Consolas', 12)
    for text_widget in root.winfo_children():
        text_widget.config(font=tk_font)
    
    # Run the tkinter main loop
    root.mainloop()

if __name__ == '__main__':
    main()
